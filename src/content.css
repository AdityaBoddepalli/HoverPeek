/* Content script styles */
:root {
  --bg: #0B0C10;
  --surface: #111218;
  --text: #F5F7FA;
  --text-weak: #BAC2CF;
  --accent: #7C9EFF;
  --accent-weak: #2A3552;
  --line: #1D2230;
  --green: #4ade80;
  --amber: #fbbf24;
  --red: #f87171;
}

@media (prefers-color-scheme: light) {
  :root {
    --bg: #FFFFFF;
    --surface: #FAFAFB;
    --text: #0E1116;
    --text-weak: #5E687E;
    --accent: #7C9EFF;
    --accent-weak: #D9E1FF;
    --line: #E7EAF0;
    --green: #22c55e;
    --amber: #f59e0b;
    --red: #ef4444;
  }
}

/* ============================================================================
   Preview Popup Base Styles
   ============================================================================ */

.link-preview-popup {
  animation: fadeIn 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  max-height: 600px;
  transition: max-height 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-12px) scale(0.96);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@media (prefers-reduced-motion: reduce) {
  .link-preview-popup {
    animation: fadeInSimple 0.15s ease-out;
  }
  
  @keyframes fadeInSimple {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
}

/* Preview hover state - subtle enhancement */
.link-preview-popup:hover {
  box-shadow: 0 12px 32px rgba(0, 0, 0, .45), 
              0 0 0 1px rgba(255, 255, 255, .04) inset;
}

.link-preview-popup:hover > div:first-child {
  /* Aurora edge glow enhancement on hover */
  filter: brightness(1.2) saturate(1.1);
}

@media (prefers-reduced-motion: reduce) {
  .link-preview-popup:hover {
    box-shadow: 0 8px 24px rgba(0, 0, 0, .4), 
                0 0 0 1px rgba(255, 255, 255, .03) inset;
  }
  .link-preview-popup:hover > div:first-child {
    filter: none;
  }
}

/* ============================================================================
   Loading State
   ============================================================================ */

.link-preview-popup.loading {
  min-height: 40px;
}

.skeleton-line {
  position: relative;
  overflow: hidden;
  animation: skeletonPulse 1.5s ease-in-out infinite;
}

.skeleton-line::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(
    90deg,
    transparent 0%,
    rgba(124, 158, 255, 0.08) 50%,
    transparent 100%
  );
  animation: skeletonShimmer 1.5s ease-in-out infinite;
}

@keyframes skeletonPulse {
  0%, 100% {
    opacity: 0.6;
  }
  50% {
    opacity: 1;
  }
}

@keyframes skeletonShimmer {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(100%);
  }
}

@media (prefers-reduced-motion: reduce) {
  .skeleton-line {
    animation: none;
  }
  .skeleton-line::after {
    animation: none;
  }
}

.shimmer {
  animation: shimmer 1.5s infinite;
}

@keyframes shimmer {
  0%, 100% {
    opacity: 0.5;
  }
  50% {
    opacity: 1;
  }
}

/* ============================================================================
   Type Chips
   ============================================================================ */

.type-chip {
  display: inline-flex;
  align-items: center;
  padding: 4px 10px;
  border-radius: 8px;
  font-size: 11px;
  font-weight: 600;
  background: var(--accent-weak);
  color: var(--text);
  border: 1px solid var(--line);
  white-space: nowrap;
  letter-spacing: 0.02em;
  text-transform: uppercase;
}

.type-chip[data-type="webpage"] {
  background: rgba(124, 158, 255, 0.15);
  border-color: rgba(124, 158, 255, 0.3);
}

.type-chip[data-type="pdf"] {
  background: rgba(239, 68, 68, 0.15);
  border-color: rgba(239, 68, 68, 0.3);
}

.type-chip[data-type="download"] {
  background: rgba(168, 85, 247, 0.15);
  border-color: rgba(168, 85, 247, 0.3);
}

.type-chip[data-type="image"] {
  background: rgba(34, 197, 94, 0.15);
  border-color: rgba(34, 197, 94, 0.3);
}

.type-chip[data-type="video"] {
  background: rgba(59, 130, 246, 0.15);
  border-color: rgba(59, 130, 246, 0.3);
}

.type-chip[data-type="mailto"] {
  background: rgba(251, 191, 36, 0.15);
  border-color: rgba(251, 191, 36, 0.3);
}

.type-chip[data-type="tel"] {
  background: rgba(251, 191, 36, 0.15);
  border-color: rgba(251, 191, 36, 0.3);
}

.type-chip[data-type="anchor"] {
  background: rgba(148, 163, 184, 0.15);
  border-color: rgba(148, 163, 184, 0.3);
}

.type-chip[data-type="blocked"] {
  background: rgba(239, 68, 68, 0.15);
  border-color: rgba(239, 68, 68, 0.3);
  color: var(--red);
}

/* ============================================================================
   Risk Badges
   ============================================================================ */

.risk-badge {
  display: inline-flex;
  align-items: center;
  padding: 4px 10px;
  border-radius: 8px;
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  white-space: nowrap;
}

.risk-badge[data-risk="green"] {
  background: rgba(74, 222, 128, 0.15);
  border: 1px solid rgba(74, 222, 128, 0.3);
  color: var(--green);
}

.risk-badge[data-risk="amber"] {
  background: rgba(251, 191, 36, 0.15);
  border: 1px solid rgba(251, 191, 36, 0.3);
  color: var(--amber);
}

.risk-badge[data-risk="red"] {
  background: rgba(248, 113, 113, 0.15);
  border: 1px solid rgba(248, 113, 113, 0.3);
  color: var(--red);
}

/* ============================================================================
   Light Mode Adjustments
   ============================================================================ */

@media (prefers-color-scheme: light) {
  .type-chip {
    background: var(--accent-weak);
  }
  
  .type-chip[data-type="blocked"] {
    color: var(--red);
  }
  
  .risk-badge[data-risk="green"] {
    background: rgba(34, 197, 94, 0.1);
    border-color: rgba(34, 197, 94, 0.25);
  }
  
  .risk-badge[data-risk="amber"] {
    background: rgba(245, 158, 11, 0.1);
    border-color: rgba(245, 158, 11, 0.25);
  }
  
  .risk-badge[data-risk="red"] {
    background: rgba(239, 68, 68, 0.1);
    border-color: rgba(239, 68, 68, 0.25);
  }
}

/* Type Chips */
.type-chip {
  display: inline-flex;
  align-items: center;
  padding: 3px 8px;
  border-radius: 8px;
  font-size: 11px;
  font-weight: 600;
  background: var(--accent-weak);
  color: var(--text);
  white-space: nowrap;
}

.type-chip[data-type="blocked"] {
  background: rgba(255, 71, 87, 0.15);
  color: #ff4757;
}

.type-chip[data-type="download"] {
  background: rgba(255, 165, 2, 0.15);
  color: #ffa502;
}

/* Risk Badges */
.risk-badge {
  display: inline-flex;
  align-items: center;
  padding: 3px 8px;
  border-radius: 8px;
  font-size: 11px;
  font-weight: 600;
  white-space: nowrap;
}

.risk-badge[data-risk="green"] {
  background: rgba(46, 213, 115, 0.15);
  color: #2ed573;
}

.risk-badge[data-risk="amber"] {
  background: rgba(255, 165, 2, 0.15);
  color: #ffa502;
}

.risk-badge[data-risk="red"] {
  background: rgba(255, 71, 87, 0.15);
  color: #ff4757;
}

/* Loading shimmer */
.link-preview-popup.loading {
  animation: shimmer 1.5s ease-in-out infinite;
}

@keyframes shimmer {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
}

.shimmer {
  background: linear-gradient(
    90deg,
    transparent 0%,
    rgba(124, 158, 255, 0.1) 50%,
    transparent 100%
  );
  background-size: 200% 100%;
  animation: shimmerMove 1.5s ease-in-out infinite;
}

@keyframes shimmerMove {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

/* ============================================================================
   AI Preview Sections
   ============================================================================ */

.preview-summary {
  animation: slideIn 0.3s ease-out;
}

.preview-outline {
  animation: slideIn 0.3s ease-out 0.1s both;
}

.preview-risk-note {
  animation: slideIn 0.3s ease-out;
}

.ai-unavailable {
  animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Streaming animation for summaries */
.preview-summary[style*="opacity: 0.8"] {
  position: relative;
}

.preview-summary[style*="opacity: 0.8"]::after {
  content: '';
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  width: 20px;
  background: linear-gradient(to right, transparent, var(--surface));
  animation: pulse 1s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% {
    opacity: 0.5;
  }
  50% {
    opacity: 1;
  }
}

/* Preview outline items */
.preview-outline div:not(:first-child) {
  transition: transform 0.2s ease;
}

.preview-outline div:not(:first-child):hover {
  transform: translateX(2px);
}

/* AI unavailable message styling */
.ai-unavailable {
  font-style: italic;
}

/* Ensure proper spacing between sections */
.link-preview-popup > div:not(:first-child) {
  margin-top: 0;
}

/* Loading spinner animation */
@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

.preview-loading {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid var(--line);
  font-size: 11.5px;
  color: var(--text-weak);
}

.preview-loading-spinner {
  width: 12px;
  height: 12px;
  border: 2px solid var(--line);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

/* ============================================================================
   Image Thumbnail Styles
   ============================================================================ */

.preview-image-thumbnail {
  animation: slideIn 0.3s ease-out;
}

.preview-image-thumbnail img {
  transition: transform 0.2s ease;
}

@media (prefers-reduced-motion: reduce) {
  .preview-image-thumbnail {
    animation: none;
  }
  .preview-image-thumbnail img {
    transition: none;
  }
}

/* ============================================================================
   Video Preview Styles
   ============================================================================ */

.preview-video {
  animation: slideIn 0.3s ease-out;
}

@media (prefers-reduced-motion: reduce) {
  .preview-video {
    animation: none;
  }
}

/* ============================================================================
   Cached Badge
   ============================================================================ */

.cached-badge {
  animation: fadeIn 0.2s ease-out;
}

@media (prefers-reduced-motion: reduce) {
  .cached-badge {
    animation: none;
  }
}

/* ============================================================================
   Shake Animation for Blocked Links
   ============================================================================ */

@keyframes shake {
  0%, 100% {
    transform: translateX(0);
  }
  10%, 30%, 50%, 70%, 90% {
    transform: translateX(-4px);
  }
  20%, 40%, 60%, 80% {
    transform: translateX(4px);
  }
}

@media (prefers-reduced-motion: reduce) {
  @keyframes shake {
    0%, 100% {
      transform: none;
    }
  }
}
